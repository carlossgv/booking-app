// This is you Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Company {
  companyId Int     @id @default(autoincrement())
  name      String
  address   String?
  email     String?
  managers  User[]
}

model Location {
  locationId   Int          @id @default(autoincrement())
  name         String
  description  String?
  address      String?
  phone        String?
  email        String?
  locationType LocationType @default(other)
  isActive     Boolean      @default(true)
  userType     UserType
  schedules    Schedule[]

  @@unique([name])
}

enum LocationType {
  restaurant  @map("Restaurant")
  bar         @map("Bar")
  cafe        @map("Cafe")
  gym         @map("Gym")
  other       @map("Other")
}

enum UserType {
  patient  @map("Patient")
  client   @map("Client")
  guest    @map("Guest")
}

model User {
  id               Int           @id @default(autoincrement()) @map("LocationUserId")
  userId           Int
  locationId       Int
  isActive         Boolean
  Company          Company?      @relation(fields: [companyCompanyId], references: [companyId])
  companyCompanyId Int?
  Reservation      Reservation[]
}

model Reservation {
  reservationId      Int       @id @default(autoincrement())
  date               DateTime
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
  locationId         Int
  userLocationUserId Int
  Schedule           Schedule? @relation(fields: [scheduleScheduleId], references: [scheduleId])
  scheduleScheduleId Int?
  user               User      @relation(fields: [userId], references: [id])
  userId             Int
}

model Schedule {
  scheduleId         Int           @id @default(autoincrement())
  date               DateTime
  initialTime        Int
  finishTime         Int
  maxReservations    Int
  repeatition        Repeatition   @default(none)
  endDate            DateTime?
  Location           Location?     @relation(fields: [locationLocationId], references: [locationId])
  locationLocationId Int?
  reservations       Reservation[]
}

enum Repeatition {
  none         @map("None")
  daily        @map("Daily")
  weekly       @map("Weekly")
  monthly      @map("Monthly")
  montofriday  @map("Monday to Friday")
}
